<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#0a0a0f">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>XD Messenger</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;500;600;700&family=DM+Sans:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div id="app">
    <!-- –≠–∫—Ä–∞–Ω –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è -->
    <section id="screen-welcome" class="screen active">
      <div class="welcome-content">
        <div class="logo">
          <span class="logo-icon">‚óÜ</span>
          <h1>XD Messenger</h1>
        </div>
        <p class="tagline">–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —á–∞—Ç –ø–æ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–º—É –∫–ª—é—á—É</p>
        <div class="welcome-actions">
          <button id="btn-start" class="btn btn-primary btn-lg">–ù–∞—á–∞—Ç—å</button>
        </div>
      </div>
    </section>

    <!-- –≠–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞ (–∞–∫–∫–∞—É–Ω—Ç) -->
    <section id="screen-account" class="screen">
      <div class="screen-header">
        <button class="btn-back" data-back="welcome" aria-label="–ù–∞–∑–∞–¥">‚Üê</button>
        <h2>–í–∞—à –∞–∫–∫–∞—É–Ω—Ç</h2>
      </div>
      <div class="screen-body">
        <p class="hint">–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –∏–º—è –¥–ª—è —Å–µ–±—è. –ï–≥–æ —É–≤–∏–¥–∏—Ç —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫.</p>
        <input type="text" id="input-account" placeholder="–ú–æ—ë –∏–º—è" maxlength="30" autocomplete="off">
        <button id="btn-continue" class="btn btn-primary btn-block">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
      </div>
    </section>

    <!-- –ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω (—Å–æ–∑–¥–∞—Ç—å / –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è) -->
    <section id="screen-main" class="screen">
      <div class="screen-header">
        <h2>–ü—Ä–∏–≤–µ—Ç, <span id="current-account"></span></h2>
        <button id="btn-logout" class="btn-ghost">–í—ã–π—Ç–∏</button>
      </div>
      <div class="screen-body">
        <div id="continue-chat-wrap" class="continue-wrap" style="display:none">
          <button id="btn-continue-chat" class="btn btn-ghost btn-block" style="margin-bottom:1rem">‚Ü© –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —á–∞—Ç</button>
        </div>
        <div class="main-actions">
          <button id="btn-create-chat" class="action-card">
            <span class="action-icon">üîë</span>
            <h3>–°–æ–∑–¥–∞—Ç—å —á–∞—Ç</h3>
            <p>–ü–æ–ª—É—á–∏—Ç–µ –∫–ª—é—á –∏ –ø–æ–¥–µ–ª–∏—Ç–µ—Å—å –∏–º —Å —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–æ–º</p>
          </button>
          <button id="btn-join-chat" class="action-card">
            <span class="action-icon">üîó</span>
            <h3>–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è</h3>
            <p>–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á –∏ –∞–∫–∫–∞—É–Ω—Ç —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞</p>
          </button>
        </div>
      </div>
    </section>

    <!-- –°–æ–∑–¥–∞–Ω–∏–µ —á–∞—Ç–∞ ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –∫–ª—é—á -->
    <section id="screen-created" class="screen">
      <div class="screen-header">
        <button class="btn-back" data-back="main" aria-label="–ù–∞–∑–∞–¥">‚Üê</button>
        <h2>–ß–∞—Ç —Å–æ–∑–¥–∞–Ω</h2>
      </div>
      <div class="screen-body">
        <p class="hint">–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫—É:</p>
        <div class="key-display">
          <div class="key-row">
            <span class="key-label">–ê–∫–∫–∞—É–Ω—Ç:</span>
            <code id="share-account"></code>
            <button class="btn-copy" data-copy="account">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
          </div>
          <div class="key-row">
            <span class="key-label">–ö–ª—é—á:</span>
            <code id="share-key"></code>
            <button class="btn-copy" data-copy="key">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
          </div>
        </div>
        <p class="key-note">‚ö†Ô∏è –ö–ª—é—á –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–π. –ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –æ–Ω –Ω–µ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è.</p>
        <button id="btn-open-created-chat" class="btn btn-primary btn-block">–û—Ç–∫—Ä—ã—Ç—å —á–∞—Ç</button>
      </div>
    </section>

    <!-- –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ —á–∞—Ç—É -->
    <section id="screen-join" class="screen">
      <div class="screen-header">
        <button class="btn-back" data-back="main" aria-label="–ù–∞–∑–∞–¥">‚Üê</button>
        <h2>–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è</h2>
      </div>
      <div class="screen-body">
        <p class="hint">–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞:</p>
        <input type="text" id="input-join-account" placeholder="–ê–∫–∫–∞—É–Ω—Ç —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞" autocomplete="off">
        <input type="text" id="input-join-key" placeholder="–û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–π –∫–ª—é—á" autocomplete="off">
        <button id="btn-do-join" class="btn btn-primary btn-block">–í–æ–π—Ç–∏ –≤ —á–∞—Ç</button>
      </div>
    </section>

    <!-- –≠–∫—Ä–∞–Ω —á–∞—Ç–∞ -->
    <section id="screen-chat" class="screen">
      <div class="chat-header">
        <button class="btn-back" data-back="main" aria-label="–ù–∞–∑–∞–¥">‚Üê</button>
        <div class="chat-info">
          <h3 id="chat-with">–ß–∞—Ç</h3>
          <span id="chat-status" class="status"></span>
        </div>
      </div>
      <div id="messages-container" class="messages-container">
        <div id="messages-list" class="messages-list"></div>
      </div>
      <div class="chat-input-wrap">
        <input type="text" id="message-input" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ..." maxlength="1000" autocomplete="off">
        <button id="btn-send" class="btn-send" aria-label="–û—Ç–ø—Ä–∞–≤–∏—Ç—å">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/>
          </svg>
        </button>
      </div>
    </section>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="config.js"></script>
  <script src="app.js"></script>
</body>
</html>
